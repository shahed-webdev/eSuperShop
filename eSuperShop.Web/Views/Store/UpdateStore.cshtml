@using eSuperShop.Repository
@model VendorStoreInfoUpdateModel

@{
    ViewData["Title"] = "Update Store";
    Layout = "_SellerLayout";
}

@section Styles{
    <style>
        #categories .delete { cursor: pointer }
        .defaut-img { padding: .62rem .59rem; background-color: #ddd; color: #666; }
    </style>   
}


<div class="container">
    <h4 class="page-header">Update Store</h4>

    <div class="card card-body">
        <form id="addForm">
            <div class="md-form">
                <label asp-for="StoreName">Store Name</label>
                <input asp-for="StoreName" class="form-control" required>
            </div>
            <div class="md-form">
                <label asp-for="StoreAddress">Store Address</label>
                <input asp-for="StoreAddress" class="form-control" required>
            </div>
            <div class="md-form">
                <label asp-for="StoreSlugUrl">Store SlugUrl</label>
                <input asp-for="StoreSlugUrl" class="form-control" required>
            </div>
            <div class="md-form">
                <label asp-for="StoreTagLine">Store Tag Line</label>
                <input asp-for="StoreTagLine" class="form-control" required>
            </div>
            <div class="md-form mb-0">
                <div class="file-field">
                    <div class="btn btn-outline-danger btn-rounded btn-sm float-left">
                        <span>Choose Logo<i class="fas fa-upload ml-3" aria-hidden="true"></i></span>
                        <input id="fileImage" type="file" accept="image/*">
                    </div>
                    <div class="file-path-wrapper">
                        <input id="filePath" class="file-path validate" type="text" placeholder="Upload Logo">
                    </div>
                </div>
            </div>

            <div class="md-form text-center">
                <input id="btnSubmit" type="submit" value="Submit" class="btn btn-danger" />
            </div>
        </form>
    </div>
</div>




@section Scripts{
    <script>
        const addForm = document.getElementById('addForm');
        const btnSubmit = addForm.btnSubmit;

        //set image file
        $('#fileImage').change(function(e) {
            const pathInput = $('#filePath');
            const size = e.target.files[0].size / 1024 / 1024;
            const allowSize = 1;
            const regex = new RegExp("(.*?)\.(jpeg|jpg|png|webp)$");

            if (!(regex.test(e.target.value.toLowerCase()))) {
                e.target.value = "";
                pathInput.val("");

                imageError.text(`Please select correct file format`);
                return;
            }

            if (size > allowSize) {
                e.target.value = "";
                pathInput.val("");

                imageError.text(`image size must be less than ${allowSize}MB. your file size:${size.toFixed()} MB`);
                return;
            }

            pathInput.val(e.target.files[0].name);
        });


        //post data
        addForm.addEventListener('submit', function(evt) {
            evt.preventDefault();

            btnSubmit.disabled = true;
            btnSubmit.value = "submitting..";

            const data = {}

            $.ajax({
                type: "POST",
                url: "/Store/UpdateStore",
                data,
                success: function(response) {
                    btnSubmit.disabled = false;
                    btnSubmit.value = "Add";

                    if (!response.IsSuccess) return;
                },
                error: function(err) {
                    console.log(err);
                    btnSubmit.disabled = false;
                    btnSubmit.value = "Add";
                }
            });
        });
    </script>
}
